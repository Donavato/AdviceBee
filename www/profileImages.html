<!--
Accessed by clicking on the profile picture from the profile page, here the user can update their profile picture by uploading
and submitting a new image.
-->
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Security-Policy" 
            content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; 
            style-src 'self' 'unsafe-inline'; 
            media-src *; 
            script-src 'self' 'unsafe-inline';
            img-src 'self' data: content:;">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <!--Popup style sheet-->
    <link rel="stylesheet" type="text/css" href="css/popup.css"/>
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <title>Take Pictures</title>
        <style>
            #btn{
                font-size: 1.5rem;
                line-height: 2.5rem;
                margin: 1rem;
            }
            #msg{
                border: 1px solid #eee;
                padding: 1rem;
                margin: 1rem;
            }
        </style>
    </head>
    <body>
        <div class="page">
            <p><img src="/ui/create.png" alt="image" id="photo" /></p>
            <p><button id="btn">TAKE</button></p>
            <br>
            <p><button id="btn2">UPLOAD</button></p>
            <p id="msg"></p>
        </div>
         <div class="hover-bkgr-fricc">      <!--Add this div to page for pop up-->
            <span class="helper"></span>
            <div>
                 
                <p id="popuptext" class="popupText"></p>          <!--Append popup here-->
            </div>
        </div>
        <script type="text/javascript" src="cordova.js"></script>
        <script>
            let app = {
                //wait for button to be clicked
                init: function(){
                    document.getElementById('btn').addEventListener('click', app.takephoto);
                    document.getElementById('btn2').addEventListener('click', app.pullphoto);
                },
                //when button clicked start this function
                takephoto: function(){
                    //options for camera function
                    let opts = {
                        quality: 25,
                        destinationType: Camera.DestinationType.FILE_URI,
                        sourceType: Camera.PictureSourceType.CAMERA,
                        mediaType: Camera.MediaType.PICTURE,
                        encodingType: Camera.EncodingType.JPEG,
                        cameraDirection: Camera.Direction.BACK,
                        targetWidth: 100,
                        targetHeight: 200
                    };
                    //navigate the page to the camera on the mobile app
                    navigator.camera.getPicture(app.success, app.fail, opts);
                },
                pullphoto: function(){
                    let opts = {
                        quality: 25,
                        destinationType: Camera.DestinationType.FILE_URI,
                        sourceType: Camera.PictureSourceType.PHOTOLIBRARY,
                        mediaType: Camera.MediaType.PICTURE,
                        encodingType: Camera.EncodingType.JPEG,
                        cameraDirection: Camera.Direction.BACK,
                        targetWidth: 100,
                        targetHeight: 200
                    }
                    navigator.camera.getPicture(app.success, app.fail, opts);
                },
                //ON SUCCESS use image URI file type. this is a string file type
                success: function(image){
                    document.getElementById('msg').textContent = image;
                    document.getElementById('photo').src = image;
                    console.log(image);
                },
                //FUNCTION FAILED
                fail: function(response){
                    document.getElementById('msg').textContent = response;
                }
            };
            
            document.addEventListener('deviceready', app.init);
        </script>
<script src="js/popup.js"></script>
    </body>
</html>